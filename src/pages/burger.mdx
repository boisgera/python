---
context:
title: I Can Has Cheezburger?
description: A graphical interface to get some fast food
date: "2024-01-05 17:00"
authors:
  - name: S√©bastien Boisg√©rault
    title: Associate Professor
    email: Sebastien.Boisgerault@minesparis.psl.eu
    url: https://eul.ink
    image: https://2.gravatar.com/avatar/39ec5d637b0753448b97a8e63855a45cb6708d033b656fe9f1d3314bb4bfb202?size=128
    affiliation: ITN Mines Paris ‚Äì PSL
    twitter: "boisgera"
    github: "boisgera"
    linkedin: "S√©bastien Boisg√©rault"
tags: [Python, flet, GUI]
license: "CC BY 4.0"
layout: ../layouts/MDXLayout.astro
---

import Admonition from "/src/components/Admonition.astro";
import Header from "/src/components/Header.astro";
import { Image } from "astro:assets";

export const debug = true;

<Header frontmatter={frontmatter} />

import burger from "/src/assets/burger.jpg";

<Image
  transition:name="burgerImage"
  src={burger}
  alt="Photo by sk on Unsplash"
  style="border-radius: 0.375rem; width: 100%; height: auto; height: auto;"
/>


Au commencement ...
================================================================================

[Flet](https://flet.dev/) est une biblioth√®que Python permettant de r√©aliser
des applications graphiques. 

Mettez en oeuvre l'exemple donn√© dans [l'introduction de sa documentation](https://flet.dev/docs/) pour vous familiariser avec elle.

import counter from "/src/assets/flet-counter.png";

<Image
  src={counter}
  alt="Flet counter"
  style="border-radius: 0.375rem; width: 75%; height: auto; height: auto;"
/>

Architecture graphique
================================================================================

D√©veloppez l'architecture graphique d'une application de commande de
menu, repr√©sent√©e dans la figure ci-dessous :


import burgerGUI from "/src/assets/burger-gui.png";

<Image
  src={burgerGUI}
  alt="Graphical user interface for menu order"
  style="border-radius: 0.375rem; width: 75%; height: auto; height: auto;"
/>


Vous allez pour ce faire devoir explorer la documentation des 
[composants](https://flet.dev/docs/controls) propos√©s par flet.

Dans un premier temps :

  - Rien n'est "fonctionnel" dans votre interface: 
    toutes les valeurs num√©riques sont cod√©es "en dur",
    il ne se passe rien quand on clique sur un bouton, etc.

  - Ne vous en faites pas si l'apparence de votre interface n'est pas exactement
    la m√™me que celle donn√©e en exemple. Il sera toujours temps d'y revenir
    plus tard pour affiner cette repr√©sentation.

Vous pouvez utiliser [https://emojipedia.org] pour trouvez les √©mojis dont
vous avez besoin (üçî hamburger, üçü frites, etc.)

<Admonition type="solution" open={debug}>

```python
from flet import app, icons
from flet import MainAxisAlignment
from flet import (
    Card,
    Column,
    Container,
    Divider,
    FilledButton,
    IconButton,
    Markdown,
    Row,
    Text,
    TextField,
)


def main(page):
    page.title = "I Can Has Cheezburger?"
    page.window_width = 400
    page.window_height = 430
    page.add(
        Column(
            alignment=MainAxisAlignment.CENTER,
            controls=[
                Row(
                    [
                        Text("üçî", size=50),
                        Text("5.95 ‚Ç¨"),
                        Container(
                            width=100,
                            content=TextField(
                                value="0", read_only=True
                            ),
                        ),
                        IconButton(icon=icons.ADD),
                        IconButton(icon=icons.REMOVE),
                    ],
                    alignment=MainAxisAlignment.CENTER,
                ),
                Row(
                    [
                        Text("üçü", size=50),
                        Text("3.60 ‚Ç¨"),
                        Container(
                            width=100,
                            content=TextField(value="0"),
                        ),
                        IconButton(icon=icons.ADD),
                        IconButton(icon=icons.REMOVE),
                    ],
                    alignment=MainAxisAlignment.CENTER,
                ),
                Row(
                    [
                        Text("ü•ó", size=50),
                        Text("8.30 ‚Ç¨"),
                        Container(
                            width=100,
                            content=TextField(value="0"),
                        ),
                        IconButton(icon=icons.ADD),
                        IconButton(icon=icons.REMOVE),
                    ],
                    alignment=MainAxisAlignment.CENTER,
                ),
                Row(
                    [
                        Text("ü•§", size=50),
                        Text("2.60 ‚Ç¨"),
                        Container(
                            width=100,
                            content=TextField(value="0"),
                        ),
                        IconButton(icon=icons.ADD),
                        IconButton(icon=icons.REMOVE),
                    ],
                    alignment=MainAxisAlignment.CENTER,
                ),
                Divider(),
                Row(
                    [
                        Card(
                            Container(
                                Markdown(
                                    "**TOTAL:** 0.00 ‚Ç¨"
                                ),
                                padding=10,
                            )
                        ),
                        FilledButton(
                            text="Buy", icon=icons.PAYMENT
                        ),
                    ],
                    alignment=MainAxisAlignment.SPACE_BETWEEN,
                ),
            ],
        )
    )


app(target=main)
```
</Admonition>


Composant sur mesure
================================================================================

La documentation de flet explique comment vous pouvez cr√©er 
[vos propres composants](https://flet.dev/docs/guides/python/user-controls). 
Utilis√©e judicieusement, cette possibilit√© devait vous permettre
de rendre l'architecture de votre application de commande plus lisible.

Id√©alement, on souhaiterait avoir un composant `Product` qui prend en charge
la repr√©sentation d'un produit, l'affichage de son prix ainsi que le comptage
du nombre d'unit√©s que le client souhaite en commander. L'application qui
en r√©sulte pourrait alors prendre la forme suivante :

```python
from flet import app, icons
from flet import MainAxisAlignment
from flet import (
    Card,
    Column,
    Container,
    Divider,
    FilledButton,
    IconButton,
    Markdown,
    Row,
    Text,
    TextField,
)

from product import Product


def main(page):
    page.title = "I Can Has Cheezburger?"
    page.window_width = 400
    page.window_height = 430
    page.add(
        Column(
            alignment=MainAxisAlignment.CENTER,
            controls=[
                Product("üçî", 5.95),
                Product("üçü", 3.60),
                Product("ü•ó", 8.30),
                Product("ü•§", 2.60),
                Divider(),
                Row(
                    [
                        Card(
                            Container(
                                Markdown(
                                    "**TOTAL:** 0.00 ‚Ç¨"
                                ),
                                padding=10,
                            )
                        ),
                        FilledButton(
                            text="Buy", icon=icons.PAYMENT
                        ),
                    ],
                    alignment=MainAxisAlignment.SPACE_BETWEEN,
                ),
            ],
        )
    )


app(target=main)
```

D√©veloppez une classe `Product` dans un fichier `product.py` pour faire en
sorte que cette nouveau programme fonctionne (comme pr√©c√©demment).


<Admonition type="solution" open={debug}>


```python
from flet import icons
from flet import MainAxisAlignment
from flet import (
    IconButton,
    Container,
    Row,
    Text,
    TextField,
    UserControl,
)


class Product(UserControl):
    def __init__(self, emoji, price):
        super().__init__()
        self.price = price
        self.emoji = emoji

    def build(self):
        return Row(
            [
                Text(self.emoji, size=50),
                Text(f"{self.price:.2f} ‚Ç¨"),
                Container(
                    width=100, content=TextField(value="0")
                ),
                IconButton(icon=icons.ADD),
                IconButton(icon=icons.REMOVE),
            ],
            alignment=MainAxisAlignment.CENTER,
        )
```

</Admonition>


Composant localement fonctionnel
================================================================================

Faites en sorte que les boutons `+` et `-` de votre composant `Product`
incr√©mentent et d√©cr√©mentent la quantit√© du produit. Ne vous pr√©ocuppez
pas encore du total de la commande. Par contre, assurez-vous que la 
quantit√© d'unit√© command√©e d'un produit ne puisse pas √™tre n√©gative.

<Admonition type="solution" open={debug}>

```python
from flet import icons
from flet import MainAxisAlignment
from flet import (
    IconButton,
    Container,
    Row,
    Text,
    TextField,
    UserControl,
)


class Product(UserControl):
    def __init__(self, emoji, price):
        super().__init__()
        self.price = price
        self.emoji = emoji
        self.quantity = 0

    def add_one(self, event):
        self.quantity += 1
        self.price_field.value = str(self.quantity)
        self.update()

    def remove_one(self, event):
        self.quantity -= 1
        self.quantity = max(self.quantity, 0)
        self.price_field.value = str(self.quantity)
        self.update()

    def build(self):
        more = IconButton(
            icon=icons.ADD, on_click=self.add_one
        )
        less = IconButton(
            icon=icons.REMOVE, on_click=self.remove_one
        )
        self.price_field = TextField(
            value=str(self.quantity), read_only=True
        )

        return Row(
            [
                Text(self.emoji, size=50),
                Text(f"{self.price:.2f} ‚Ç¨"),
                Container(
                    width=100, content=self.price_field
                ),
                more,
                less,
            ],
            alignment=MainAxisAlignment.CENTER,
        )
```

</Admonition>


Composant pleinement fonctionnel
================================================================================

Il manque deux choses √† notre composant produit :

  - Un attribut (ou une propri√©t√©) `total` qui permet de savoir
    combien le nombre d'unit√©s choisi de ce composant va co√ªter.

    ```python
    hamburgers = Product("üçî", 5.95)
    hamburgers.total  # 0.0 initially
    ```

  - Un "hook" (optionnel) permettant de signaler √† l'utilisateur du composant 
    que le nombre d'unit√©s (et donc le co√ªt) de ce produit a chang√©. 
    Ce hook prendra la forme d'une fonction de callback que l'on fournit 
    au produit lors de sa construction:
   
    ```python
    def print_hamburgers_total(event):
        print(hamburgers.total)

    hamburgers = Product("üçî", 5.95, on_change=print_hamburgers_total)
    ```

R√©alisez les changements n√©cessaires dans `product.py`. 

<Admonition type="solution" open={debug}>


```python
from flet import icons
from flet import MainAxisAlignment
from flet import (
    IconButton,
    Container
    Row,
    Text,
    TextField,
    UserControl,
)


def do_nothing(event):
    pass


class Product(UserControl):
    def __init__(self, emoji, price, on_change=None):
        super().__init__()
        self.price = price
        self.emoji = emoji
        self.quantity = 0
        self.on_change = on_change or do_nothing

    def get_total(self):
        return self.price * self.quantity

    total = property(get_total)

    def add_one(self, event):
        self.quantity += 1
        self.price_field.value = str(self.quantity)
        self.on_change(event)
        self.update()

    def remove_one(self, event):
        self.quantity -= 1
        self.quantity = max(self.quantity, 0)
        self.price_field.value = str(self.quantity)
        self.on_change(event)
        self.update()

    def build(self):
        more = IconButton(
            icon=icons.ADD, on_click=self.add_one
        )
        less = IconButton(
            icon=icons.REMOVE, on_click=self.remove_one
        )
        self.price_field = TextField(
            value=str(self.quantity), read_only=True
        )

        return Row(
            [
                Text(self.emoji, size=50),
                Text(f"{self.price:.2f} ‚Ç¨"),
                Container(
                    width=100, content=self.price_field
                ),
                more,
                less,
            ],
            alignment=MainAxisAlignment.CENTER,
        )
```

</Admonition>

Int√©gration
================================================================================

Compl√©tez votre application pour que le total de la commande soit toujours √† jour.

<Admonition type="solution" open={debug}>

```python
from flet import app, icons
from flet import MainAxisAlignment
from flet import (
    Card,
    Column,
    Container,
    Divider,
    FilledButton,
    Markdown,
    Row,
)

from product import Product


def main(page):
    page.title = "I Can Has Cheezburger?"
    page.window_width = 400
    page.window_height = 430

    total_markdown = Markdown("**Total:** 0.0 ‚Ç¨")

    def on_change(event):
        total = sum([p.total for p in products])
        total_markdown.value = f"**Total:** {total:.2f} ‚Ç¨"
        page.update()

    products = [
        Product("üçî", 5.95, on_change=on_change),
        Product("üçü", 3.60, on_change=on_change),
        Product("ü•ó", 8.30, on_change=on_change),
        Product("ü•§", 2.60, on_change=on_change),
    ]

    page.add(
        Column(
            alignment=MainAxisAlignment.CENTER,
            controls=[
                *products,
                Divider(),
                Row(
                    [
                        Card(
                            Container(
                                total_markdown, padding=10
                            )
                        ),
                        FilledButton(
                            text="Buy", icon=icons.PAYMENT
                        ),
                    ],
                    alignment=MainAxisAlignment.SPACE_BETWEEN,
                ),
            ],
        )
    )


app(target=main)
```
</Admonition>
